<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">


<html xmlns="http://www.w3.org/1999/xhtml" lang="ja">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
    <title>Operators and Bindings &mdash; Fabric Engine 2.3.0 Unofficial Documentation (ja)</title>
    
    <link rel="stylesheet" href="../_static/classic.css" type="text/css" />
    <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
    <link rel="stylesheet" href="../_static/custom.css" type="text/css" />
    
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    '../',
        VERSION:     '2.3.0',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true
      };
    </script>
    <script type="text/javascript" src="../_static/jquery.js"></script>
    <script type="text/javascript" src="../_static/underscore.js"></script>
    <script type="text/javascript" src="../_static/doctools.js"></script>
    <script type="text/javascript" src="../_static/translations.js"></script>
    <script type="text/javascript" src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
    <link rel="top" title="Fabric Engine 2.3.0 Unofficial Documentation (ja)" href="../index.html" /> 
  </head>
  <body role="document">
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>ナビゲーション</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../genindex.html" title="総合索引"
             accesskey="I">索引</a></li>
        <li class="right" >
          <a href="../py-modindex.html" title="Pythonモジュール索引"
             >モジュール</a> |</li>
        <li class="nav-item nav-item-0"><a href="../index.html">Fabric Engine 2.3.0 Unofficial Documentation (ja)</a> &raquo;</li> 
      </ul>
    </div>  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <div class="section" id="operators-and-bindings">
<span id="operators-bindings"></span><h1>Operators and Bindings<a class="headerlink" href="#operators-and-bindings" title="このヘッドラインへのパーマリンク">¶</a></h1>
<p>The KL code that runs within the dependency graph and event graph is contained in objects called Operators.  The same operator can be bound to multiple Nodes and EventHandlers by using different Bindings (see below) that share the same Operator.</p>
<div class="section" id="operator-creation">
<h2>Operator Creation<a class="headerlink" href="#operator-creation" title="このヘッドラインへのパーマリンク">¶</a></h2>
<p>An Operator is created by calling <code class="samp docutils literal"><span class="pre">fabricClient.RT.createOperator</span></code>, passing the name of the Operator as the first argument.  Operator names must be unique and not shared with any Nodes, Events or EventHandlers.</p>
<div class="highlight-none"><div class="highlight"><pre><span></span>&gt;&gt;&gt; op = fabricClient.DG.createOperator(&quot;doSomething&quot;)
&gt;&gt;&gt;
</pre></div>
</div>
</div>
<div class="section" id="setting-operator-source-code">
<h2>Setting Operator Source Code<a class="headerlink" href="#setting-operator-source-code" title="このヘッドラインへのパーマリンク">¶</a></h2>
<p>The source code contained in the Operator is set using the Operator&#8217;s <code class="samp docutils literal"><span class="pre">setSourceCode</span></code> method.  It takes a string containing the KL source code.</p>
<div class="admonition note">
<p class="first admonition-title">注釈</p>
<p class="last">Source code is first usually loaded from an external resource, using eg. the <code class="samp docutils literal"><span class="pre">fabricClient.loadResourceURL</span></code> function, rather than being included as an inline string as is done in these examples.</p>
</div>
<p>After setting the source code, you can check if any warnings or errors were generated by the KL compiler by calling the <code class="samp docutils literal"><span class="pre">getDiagnostics</span></code> method, which returns an array of objects describing the warnings/errors, including the level (warning/error), line number, column number and message.  You can later retrieve the source code by calling the <code class="samp docutils literal"><span class="pre">getSourceCode</span></code> method.</p>
<div class="highlight-none"><div class="highlight"><pre><span></span>&gt;&gt;&gt; op.setSourceCode(&quot;operator entry( io Scalar result, in Size index, in Container self ) { result = 3.14 }&quot;)
&gt;&gt;&gt; op.getDiagnostics()
[{u&#39;column&#39;: 82, u&#39;line&#39;: 1, u&#39;level&#39;: u&#39;error&#39;, u&#39;desc&#39;: u&#39;syntax error, unexpected }, expecting ;&#39;, u&#39;filename&#39;: u&#39;(unknown)&#39;}]
&gt;&gt;&gt; op.setSourceCode(&quot;operator entry( io Scalar result, in Size index, in Container self ) { result = 3.14; }&quot;)
&gt;&gt;&gt; op.getDiagnostics()
[]
&gt;&gt;&gt;
</pre></div>
</div>
</div>
<div class="section" id="setting-the-operator-entry-point">
<h2>Setting the Operator Entry Point<a class="headerlink" href="#setting-the-operator-entry-point" title="このヘッドラインへのパーマリンク">¶</a></h2>
<p>In addition to source code, an operator needs an entry point, which is the name of the KL operator (see the <a class="reference internal" href="../KLProgrammingGuide/index.html#klpg"><span class="std std-ref">KL プログラミングガイド</span></a>) in the source code that should be called when the operator is invoked.  Note that this <em>must</em> be an KL operator and not a KL function.  The entry point is specified by calling the <code class="samp docutils literal"><span class="pre">setEntryPoint</span></code> method.  By specifying the source code and entry point separately, it is possible to have multiple possible entry points into the same source code.</p>
<div class="highlight-none"><div class="highlight"><pre><span></span>&gt;&gt;&gt; op.setEntryPoint(&#39;entry&#39;)
&gt;&gt;&gt; op.getEntryPoint()
&#39;entry&#39;
&gt;&gt;&gt;
</pre></div>
</div>
</div>
<div class="section" id="bindings">
<h2>Bindings<a class="headerlink" href="#bindings" title="このヘッドラインへのパーマリンク">¶</a></h2>
<p>To make an operator run on a Node or EventHandler, you must create a Binding object which describes what data the KL operator arguments are bound to when the operator is run.</p>
<div class="admonition note">
<p class="first admonition-title">注釈</p>
<p class="last">It is possible to have multiple bindings that all share a single operator.</p>
</div>
<p>A binding object is created by calling <code class="samp docutils literal"><span class="pre">fabricClient.DG.createBinding</span></code>, and you set the Operator called by the Binding by calling the Binding&#8217;s <code class="samp docutils literal"><span class="pre">setOperator</span></code> method.  This operator can later be retrieved by calling the Binding&#8217;s <code class="samp docutils literal"><span class="pre">getOperator</span></code> method.</p>
<div class="highlight-none"><div class="highlight"><pre><span></span>&gt;&gt;&gt; binding = fabricClient.DG.createBinding()
&gt;&gt;&gt; binding.setOperator(op)
&gt;&gt;&gt; binding.getOperator()
&lt;fabric._OPERATOR object at 0x1958e50&gt;
&gt;&gt;&gt;
</pre></div>
</div>
</div>
<div class="section" id="binding-parameter-layouts">
<h2>Binding Parameter Layouts<a class="headerlink" href="#binding-parameter-layouts" title="このヘッドラインへのパーマリンク">¶</a></h2>
<p>The way in which the KL operator arguments are bound is specified by calling the Binding&#8217;s <code class="samp docutils literal"><span class="pre">setParameterLayout</span></code> method.  <code class="samp docutils literal"><span class="pre">setParameterLayout</span></code> takes a single parameter that is an array of strings.  The length of the array must be equal to the number of parameters taken by the KL operator in the Operator&#8217;s source code, and each string describes what data that parameter should bind to.</p>
<p>Such string is of the format <code class="samp docutils literal"><em><span class="pre">object</span></em><span class="pre">.</span><em><span class="pre">member</span></em></code>, or <code class="samp docutils literal"><em><span class="pre">object</span></em></code> for a special usage which we will detail later.  The <code class="samp docutils literal"><em><span class="pre">object</span></em></code> part refers to what Node, EventHandler or Event object contains the data to be bound, as follows:</p>
<ul class="simple">
<li>If <code class="samp docutils literal"><em><span class="pre">object</span></em></code> is <code class="samp docutils literal"><span class="pre">self</span></code>, the data is contained on the object where the binding is attached</li>
<li>For Bindings that live on Nodes, <code class="samp docutils literal"><em><span class="pre">object</span></em></code> is the name of the direct dependency Node that contains the data</li>
<li>For Bindings that live on EventHandlers, <code class="samp docutils literal"><em><span class="pre">object</span></em></code> is the name of an ancestor EventHandler in the call chain as specified by a call to its <code class="samp docutils literal"><span class="pre">setScopeName</span></code> method, or a Node that is connected to the EventHandler through a call to the EventHandlers&#8217;s <code class="samp docutils literal"><span class="pre">setScope</span></code> method.</li>
</ul>
<p>The <code class="samp docutils literal"><em><span class="pre">member</span></em></code> part refers to the data member on the object specified by <code class="samp docutils literal"><em><span class="pre">object</span></em></code>, with support for the following additional syntaxes:</p>
<ul class="simple">
<li>If <code class="samp docutils literal"><em><span class="pre">member</span></em></code> is simply the name of a member (eg. &#8220;position&#8221;), the parameter will be bound to that member once for each slice.  The operator will be invoked once for each slice of the Node, potentially in parallel.  The KL parameter in the operator must be an <code class="samp docutils literal"><span class="pre">io</span></code> parameter whose type is the type of the member.</li>
<li>If <code class="samp docutils literal"><em><span class="pre">member</span></em></code> is the name of a member followed by <code class="samp docutils literal"><span class="pre">[]</span></code> (eg. <code class="samp docutils literal"><span class="pre">position[]</span></code>), the parameter will be bound to a variable-length array that contains the data for <em>all</em> the slices for that member.  The length of the array will be equal to the slice count of the Node.  The KL parameter in the operator must be an <code class="samp docutils literal"><span class="pre">io</span></code> parameter whose type is a variable-length array of the type of the member.</li>
<li>If <code class="samp docutils literal"><em><span class="pre">member</span></em></code> is <code class="samp docutils literal"><span class="pre">index</span></code>, the parameter will be index of the current slice for which the operator is being executed.  The parameter must be an <code class="samp docutils literal"><span class="pre">in</span></code> parameter of type <code class="samp docutils literal"><span class="pre">Index</span></code> (or, equivalently, <code class="samp docutils literal"><span class="pre">Size</span></code>)</li>
<li>If <code class="samp docutils literal"><em><span class="pre">object</span></em></code> is specified (instead of <code class="samp docutils literal"><em><span class="pre">object</span></em><span class="pre">.</span><em><span class="pre">member</span></em></code>), then the parameter must be of type <code class="samp docutils literal"><span class="pre">Container</span></code>, which allows you to get or set the Node slice count in KL. Calling <code class="samp docutils literal"><span class="pre">Container</span></code>&#8216;s <code class="samp docutils literal"><span class="pre">resize(Size)</span></code> method will immediately change the slice count of the Node, and the <code class="samp docutils literal"><span class="pre">size()</span></code> method will return its current slice count. The <code class="samp docutils literal"><span class="pre">resize(Size)</span></code> method requires that the parameter is specified as <code class="samp docutils literal"><span class="pre">io</span></code>.</li>
</ul>
<div class="highlight-none"><div class="highlight"><pre><span></span>&gt;&gt;&gt; binding.setParameterLayout( [&quot;self.result&quot;,&quot;self.index&quot;,&quot;self&quot;] )
&gt;&gt;&gt; node = fabricClient.DG.createNode(&quot;foo&quot;)
&gt;&gt;&gt; node.bindings.append(binding)
&gt;&gt;&gt; node.getErrors()
[u&quot;binding 0: operator &#39;doSomething&#39;: node &#39;self&#39;: parameter 1: member &#39;result&#39;: &#39;result&#39;: no such member&quot;]
&gt;&gt;&gt; node.addMember(&quot;result&quot;,&quot;Scalar&quot;)
&gt;&gt;&gt; node.getErrors()
[]
&gt;&gt;&gt;
</pre></div>
</div>
<div class="admonition note">
<p class="first admonition-title">注釈</p>
<p class="last">Even when a Binding binds a parameter to a member of a dependency of a Node, rather than a member of the Node itself, the parameter must still be declared as an <code class="samp docutils literal"><span class="pre">io</span></code> parameter in KL.  This is a limitation of the system which will be removed in the future; in fact, it will become required that members of non-<code class="samp docutils literal"><span class="pre">self</span></code> objects be bound to <code class="samp docutils literal"><span class="pre">in</span></code> parameters.</p>
</div>
</div>
</div>


          </div>
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
            <p class="logo"><a href="../index.html">
              <img class="logo" src="../_static/FE_logo_211_37.png" alt="Logo"/>
            </a></p>
  <h3><a href="../index.html">目次</a></h3>
  <ul>
<li><a class="reference internal" href="#">Operators and Bindings</a><ul>
<li><a class="reference internal" href="#operator-creation">Operator Creation</a></li>
<li><a class="reference internal" href="#setting-operator-source-code">Setting Operator Source Code</a></li>
<li><a class="reference internal" href="#setting-the-operator-entry-point">Setting the Operator Entry Point</a></li>
<li><a class="reference internal" href="#bindings">Bindings</a></li>
<li><a class="reference internal" href="#binding-parameter-layouts">Binding Parameter Layouts</a></li>
</ul>
</li>
</ul>

  <div role="note" aria-label="source link">
    <h3>このページ</h3>
    <ul class="this-page-menu">
      <li><a href="../_sources/DependencyGraphProgrammingGuide/operators-bindings.txt"
            rel="nofollow">ソースコードを表示</a></li>
    <li><a href="http://docs.fabric-engine.com/FabricEngine/latest/HTML/DependencyGraphProgrammingGuide/operators-bindings.html"
              rel="nofollow">原文公式ページへ移動 (goto official page)</a></li>
    </ul>
   </div>
<div id="searchbox" style="display: none" role="search">
  <h3>クイック検索</h3>
    <form class="search" action="../search.html" method="get">
      <input type="text" name="q" />
      <input type="submit" value="検索" />
      <input type="hidden" name="check_keywords" value="yes" />
      <input type="hidden" name="area" value="default" />
    </form>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>ナビゲーション</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../genindex.html" title="総合索引"
             >索引</a></li>
        <li class="right" >
          <a href="../py-modindex.html" title="Pythonモジュール索引"
             >モジュール</a> |</li>
        <li class="nav-item nav-item-0"><a href="../index.html">Fabric Engine 2.3.0 Unofficial Documentation (ja)</a> &raquo;</li> 
      </ul>
    </div>
    <div class="footer" role="contentinfo">
        &copy; Copyright 2010-2016 Fabric Software Inc.
      このドキュメントは <a href="http://sphinx-doc.org/">Sphinx</a> 1.4.1 で生成しました。
    </div>
  </body>
</html>